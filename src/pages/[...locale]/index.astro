---
import { useI18n } from "astro-nanostores-i18n:runtime";
import Spotlight from "../../layouts/sections/Spotlight.astro";
import Shell from "../../layouts/Shell.astro";
import { defaultPropsAndParamsOptions, generateGetStaticIndexPaths } from "../../utils/paths";
import Orbiter from "../../components/Orbiter.astro";
import LogoSquare from "../../../assets/square.svg";
import MoodleLogo from "../../../assets/logos/moodle.svg";
import GitLogo from "../../../assets/logos/git.svg";
import TypescriptLogo from "../../../assets/logos/typescript.svg";
import Css3Logo from "../../../assets/logos/css3.svg";
import Html5Logo from "../../../assets/logos/html5.svg";
import PostgresqlLogo from "../../../assets/logos/postgresql.svg";
import ReactLogo from "../../../assets/logos/react.svg";
import JavascriptLogo from "../../../assets/logos/javascript.svg";
import AstroLogo from "../../../assets/logos/astro.svg";
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import { i18nProps } from "astro-loader-i18n";
import slug from "limax";
import Empower from "../../layouts/sections/Empower.astro";
import Connect from "../../layouts/sections/Connect.astro";

export const getStaticPaths = generateGetStaticIndexPaths("[...locale]");

const messages = useI18n("src/pages/[...locale]/index.astro", {
  spotlightTitle: "Empowers and Connects",
  spotlightContent: "Join us in our mission to empower and connect the EdTech space with our products.",
  spotlightActionConnect: "Connect",
  spotlightActionConnectLink: "/about-us",
  spotlightActionEmpower: "Empower",
  spotlightActionEmpowerLink: "/products",
});

const {
  translations,
  data: { locale },
} = Astro.props;

const collection = (await getCollection("products")).filter((entry) => entry.data.locale === locale);
const products = i18nProps(collection, {
  ...defaultPropsAndParamsOptions,
  routePattern: `${Astro.routePattern}/[product]`,
  generateSegments: (entry) => ({ product: slug(entry.data.title) }),
});
---

<Shell translations={translations} bodyClasses="scroll-snapping-block">
  <Spotlight>
    <h1 slot="title">{messages.spotlightTitle}</h1>
    <p slot="content">{messages.spotlightContent}</p>
    <Fragment slot="actions">
      <a href={messages.spotlightActionEmpowerLink} class="button primary">{messages.spotlightActionEmpower}</a>
      <a href={messages.spotlightActionConnectLink} class="button">{messages.spotlightActionConnect}</a>
    </Fragment>
    <Orbiter slot="stage">
      <Image slot="host" alt="Our logo as the orbiters host" src={LogoSquare} />
      <Fragment slot="orbits">
        <div class="orbit">
          <div>🎓</div>
          <div>📚</div>
          <div>💻</div>
          <div>☁️</div>
          <div>🧠</div>
          <div>💬</div>
          <div>🚀</div>
          <div>💡</div>
          <div>🧑‍🏫</div>
        </div>
        <div class="orbit">
          <Image alt="Logo of Moodle" src={MoodleLogo} />
          <Image alt="Logo of Git" src={GitLogo} />
          <Image alt="Logo of Typescript" src={TypescriptLogo} />
          <Image alt="Logo of CSS" src={Css3Logo} />
          <Image alt="Logo of HTML" src={Html5Logo} />
          <Image alt="Logo of PostgreSQL" src={PostgresqlLogo} />
          <Image alt="Logo of React" src={ReactLogo} />
          <Image alt="Logo of Javascript" src={JavascriptLogo} />
          <Image alt="Logo of Astro" src={AstroLogo} />
        </div>
      </Fragment>
    </Orbiter>
  </Spotlight>
  <Empower />
  <Connect />
</Shell>

<style>
  :global(main) {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
</style>
